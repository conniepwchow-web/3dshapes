<!DOCTYPE html>
<html lang="zh-Hant">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <!-- æ¨™é¡Œæœƒæ ¹æ“šéŠæˆ²è®Šæ›´ -->
    <title>ç«‹é«”åœ–å½¢éŠæˆ²</title>
    <!-- å¼•å…¥ Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- å¼•å…¥ Google Font (Noto Sans TC) -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+TC:wght@400;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Noto Sans TC', 'Inter', sans-serif;
        }

        /* --- éŠæˆ² 1 (çŒœçŒœçœ‹) çš„æ¨£å¼ --- */
        .g1-option-btn.correct {
            background-color: #22c55e; /* green-500 */
            color: white;
            border-color: #16a34a; /* green-700 */
            transform: scale(1.05);
        }
        .g1-option-btn.incorrect {
            background-color: #ef4444; /* red-500 */
            color: white;
            border-color: #b91c1c; /* red-700 */
        }
        .g1-option-btn.reveal {
            background-color: #22c55e; /* green-500 */
            color: white;
            border-color: #16a34a; /* green-700 */
            opacity: 1;
        }
        .g1-option-btn:disabled {
            opacity: 0.7;
            cursor: not-allowed;
        }

        /* --- éŠæˆ² 2 (é…é…çœ‹) çš„æ¨£å¼ --- */
        .g2-shape-btn, .g2-selected-shape {
            width: 80px;
            height: 80px;
            cursor: pointer;
            transition: all 0.2s ease-in-out;
        }
        
        .g2-shape-btn:hover {
            transform: scale(1.1);
        }

        .g2-shape-3d-svg {
            width: 100%;
            height: 180px;
            stroke: #333;
            stroke-width: 2;
            stroke-linecap: round;
            stroke-linejoin: round;
            fill-opacity: 0.1;
        }

        .g2-modal {
            display: none; /* é è¨­éš±è— */
            position: fixed;
            z-index: 50;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            overflow: auto;
            background-color: rgba(0, 0, 0, 0.5); /* åŠé€æ˜èƒŒæ™¯ */
            justify-content: center;
            align-items: center;
        }
        
        .g2-modal-content {
            background-color: white;
            padding: 24px;
            border-radius: 12px;
            text-align: center;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
            max-width: 90%;
            width: 320px;
        }
        
        .g2-modal-show {
            display: flex; /* é¡¯ç¤º modal */
        }

        /* --- é€šç”¨è¿”å›æŒ‰éˆ• --- */
        .back-btn {
            position: absolute;
            top: 20px;
            left: 20px;
            background-color: #f3f4f6; /* gray-100 */
            color: #374151; /* gray-700 */
            padding: 8px 16px;
            border-radius: 9999px; /* rounded-full */
            font-size: 14px;
            font-weight: 600;
            transition: background-color 0.2s;
        }
        .back-btn:hover {
            background-color: #e5e7eb; /* gray-200 */
        }
    </style>
</head>
<body class="bg-gray-100 min-h-screen flex items-center justify-center p-4">

    <!-- 
      =================================
      é–‹å§‹ç•«é¢ (é è¨­é¡¯ç¤º)
      =================================
    -->
    <main id="start-screen" class="bg-white w-full max-w-xl rounded-2xl shadow-xl p-8 sm:p-12 text-center">
        <h1 class="text-4xl sm:text-5xl font-bold text-center text-blue-700 mb-10">
            ç«‹é«”åœ–å½¢éŠæˆ²
        </h1>
        <div class="flex flex-col gap-6">
            <button id="play-guess-btn" class="w-full bg-blue-500 hover:bg-blue-600 text-white font-bold py-4 px-8 rounded-full text-xl shadow-lg transition transform hover:scale-105">
                ç«‹é«”åœ–å½¢çŒœçŒœçœ‹
            </button>
            <button id="play-match-btn" class="w-full bg-green-500 hover:bg-green-600 text-white font-bold py-4 px-8 rounded-full text-xl shadow-lg transition transform hover:scale-105">
                ç«‹é«”åœ–å½¢é…é…çœ‹
            </button>
        </div>
    </main>

    <!-- 
      =================================
      éŠæˆ² 1: ç«‹é«”åœ–å½¢çŒœçŒœçœ‹ (é è¨­éš±è—)
      =================================
    -->
    <main id="game-guess-screen" class="hidden relative bg-white w-full max-w-2xl rounded-2xl shadow-xl p-6 sm:p-10">
        
        <button class="back-btn" data-target="start-screen">
            &larr; è¿”å›
        </button>

        <h1 class="text-3xl sm:text-4xl font-bold text-center text-blue-700 mb-6">
            ç«‹é«”åœ–å½¢çŒœçŒœçœ‹
        </h1>

        <!-- é€²åº¦é¡¯ç¤º -->
        <div class="text-right text-gray-500 mb-4 font-semibold" id="g1-progress-text">
            ç¬¬ 1 / 7 é¡Œ
        </div>

        <!-- é¡Œç›®å€åŸŸ -->
        <div id="g1-question-card" class="bg-blue-50 border-2 border-blue-200 rounded-xl p-6 mb-6 min-h-[150px] flex items-center justify-center">
            <p class="text-lg sm:text-xl text-gray-800 leading-relaxed" id="g1-question-description">
                <!-- JavaScript æœƒåœ¨é€™è£¡è¼‰å…¥å•é¡Œ -->
            </p>
        </div>
        
        <!-- é¸é …å€åŸŸ -->
        <div id="g1-options-grid" class="grid grid-cols-2 md:grid-cols-4 gap-4 mb-6">
            <!-- JavaScript æœƒåœ¨é€™è£¡æ’å…¥é¸é …æŒ‰éˆ• -->
        </div>

        <!-- åé¥‹è¨Šæ¯ -->
        <div id="g1-feedback-message" class="text-center text-xl font-bold h-8 mb-4">
            <!-- JavaScript æœƒåœ¨é€™è£¡é¡¯ç¤ºç­”å°/ç­”éŒ¯ -->
        </div>

        <!-- æŒ‰éˆ•å€åŸŸ -->
        <div class="flex justify-center">
            <button id="g1-next-btn" class="hidden bg-blue-500 hover:bg-blue-600 text-white font-bold py-3 px-12 rounded-full text-lg shadow-md transition transform hover:scale-105">
                ä¸‹ä¸€é¡Œ
            </button>
            <button id="g1-restart-btn" class="hidden bg-green-500 hover:bg-green-600 text-white font-bold py-3 px-12 rounded-full text-lg shadow-md transition transform hover:scale-105">
                é‡æ–°é–‹å§‹
            </button>
        </div>
    </main>

    <!-- 
      =================================
      éŠæˆ² 2: ç«‹é«”åœ–å½¢é…é…çœ‹ (é è¨­éš±è—)
      =================================
    -->
    <main id="game-match-screen" class="hidden relative bg-white w-full max-w-3xl rounded-2xl shadow-xl p-6 sm:p-10" style="background-color: #f9fafb;"> <!-- bg-blue-50 -->

        <button class="back-btn" data-target="start-screen">
            &larr; è¿”å›
        </button>
        
        <h1 class="text-3xl sm:text-4xl font-bold text-center text-blue-700 mb-6">
            ç«‹é«”åœ–å½¢é…é…çœ‹
        </h1>

        <!-- é¡Œç›®å€åŸŸ -->
        <div id="g2-question-card" class="bg-gray-50 border-2 border-gray-200 rounded-xl p-6 mb-6 text-center">
            <p class="text-lg sm:text-xl text-gray-700 mb-4">è«‹é»é¸ä¸‹é¢æ‰€æœ‰çš„ã€Œ<span id="g2-shape-name" class="font-bold text-2xl sm:text-3xl text-indigo-600"></span>ã€æœ‰çš„é¢ï¼š</p>
            <!-- 3D åœ–å½¢é¡¯ç¤ºå€ -->
            <div id="g2-shape-visual" class="h-48 flex items-center justify-center">
                <!-- JavaScript æœƒåœ¨é€™è£¡æ’å…¥ 3D åœ–å½¢çš„ SVG -->
            </div>
        </div>

        <!-- ç©å®¶é¸æ“‡çš„ç­”æ¡ˆå€åŸŸ -->
        <div class="mb-6">
            <h2 class="font-bold text-gray-600 mb-2">ä½ é¸æ“‡çš„é¢ï¼šï¼ˆé»é¸å¯ç§»é™¤ï¼‰</h2>
            <div id="g2-selection-tray" class="bg-gray-100 rounded-lg min-h-[100px] p-4 flex flex-wrap gap-3 items-center border-2 border-dashed border-gray-300">
                <!-- ç©å®¶é»é¸çš„ 2D åœ–å½¢æœƒå‡ºç¾åœ¨é€™è£¡ -->
            </div>
        </div>
        
        <!-- 2D åœ–å½¢é¸é …å€åŸŸ -->
        <div class="mb-8">
            <h2 class="font-bold text-gray-600 mb-3 text-center">é»é¸åœ–å½¢åŠ å…¥ï¼š</h2>
            <div id="g2-shape-options" class="flex flex-wrap justify-center gap-4">
                <!-- JavaScript æœƒåœ¨é€™è£¡æ’å…¥ 2D åœ–å½¢æŒ‰éˆ• -->
            </div>
        </div>

        <!-- æŒ‰éˆ•å€åŸŸ -->
        <div class="flex flex-col sm:flex-row justify-center gap-4">
            <button id="g2-clear-btn" class="w-full sm:w-auto bg-yellow-500 hover:bg-yellow-600 text-white font-bold py-3 px-8 rounded-full text-lg shadow-md transition transform hover:scale-105">
                å…¨éƒ¨æ¸…é™¤
            </button>
            <button id="g2-check-btn" class="w-full sm:w-auto bg-green-500 hover:bg-green-600 text-white font-bold py-3 px-8 rounded-full text-lg shadow-md transition transform hover:scale-105">
                æª¢æŸ¥ç­”æ¡ˆ
            </button>
            <button id="g2-next-btn" class="w-full sm:w-auto bg-blue-500 hover:bg-blue-600 text-white font-bold py-3 px-8 rounded-full text-lg shadow-md transition transform hover:scale-105 hidden">
                ä¸‹ä¸€é¡Œ
            </button>
        </div>
    </main>

    <!-- å½ˆçª— Modal (ç”¨æ–¼éŠæˆ² 2) -->
    <div id="g2-feedback-modal" class="g2-modal">
        <div class="g2-modal-content">
            <div id="g2-modal-icon" class="text-6xl mb-4"></div>
            <h2 id="g2-modal-title" class="text-2xl font-bold mb-3"></h2>
            <p id="g2-modal-message" class="text-gray-700 mb-6"></p>
            <button id="g2-modal-close-btn" class="bg-blue-500 hover:bg-blue-600 text-white font-bold py-2 px-6 rounded-full text-lg">
                çŸ¥é“äº†
            </button>
        </div>
    </div>

    <script>
        // 
        // =================================
        // éŠæˆ² 1: ç«‹é«”åœ–å½¢çŒœçŒœçœ‹ (é‚è¼¯)
        // =================================
        //
        const GameGuess = {
            // --- è³‡æ–™åº« ---
            shapesSVG: {
                "ä¸‰è§’æŸ±": `<svg class="w-20 h-20" viewBox="0 0 200 150" stroke="#333" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" fill-opacity="0.1">
                            <polygon points="50,30 130,30 90,60" fill="#f87171" />
                            <polygon points="50,100 130,100 90,130" fill="#f87171" style="fill-opacity: 0.3;" />
                            <path d="M50,30 L50,100" />
                            <path d="M130,30 L130,100" />
                            <path d="M90,60 L90,130" />
                            <polygon points="50,30 130,30 130,100 50,100" fill="#34d399" />
                            <polygon points="130,30 90,60 90,130 130,100" fill="#34d399" />
                            <polygon points="50,30 90,60 90,130 50,100" fill="#34d399" style="fill-opacity: 0.3;" />
                            <path d="M50,100 L90,130 L130,100" stroke-dasharray="4 4" fill="none" />
                        </svg>`,
                "ä¸‰è§’éŒ": `<svg class="w-20 h-20" viewBox="0 0 200 150" stroke="#333" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" fill-opacity="0.1">
                            <polygon points="50,130 150,130 100,100" fill="#f87171" style="fill-opacity: 0.3;" />
                            <path d="M100,30 L50,130" />
                            <path d="M100,30 L150,130" />
                            <path d="M100,30 L100,100" stroke-dasharray="4 4" />
                            <polygon points="100,30 50,130 150,130" fill="#f87171" />
                            <polygon points="100,30 150,130 100,100" fill="#f87171" />
                            <polygon points="100,30 50,130 100,100" fill="#f87171" style="fill-opacity: 0.3;" />
                            <path d="M50,130 L100,100 L150,130" stroke-dasharray="4 4" fill="none" />
                        </svg>`,
                "å››è§’æŸ±": `<svg class="w-20 h-20" viewBox="0 0 200 150" stroke="#333" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" fill-opacity="0.1">
                            <rect x="50" y="30" width="100" height="90" fill="#34d399" />
                            <rect x="70" y="50" width="100" height="90" fill="#34d399" style="fill-opacity: 0.2;" stroke-dasharray="5 5" />
                            <path d="M50,30 L70,50 M150,30 L170,50 M50,120 L70,140 M150,120 L170,140" />
                            <rect x="70" y="50" width="100" height="90" stroke="none" fill="#34d399" />
                        </svg>`,
                "å››è§’éŒ": `<svg class="w-20 h-20" viewBox="0 0 200 150" stroke="#333" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" fill-opacity="0.1">
                            <polygon points="50,120 150,120 130,100 70,100" fill="#34d399" />
                            <path d="M100,30 L50,120 L150,120 Z" fill="#f87171" />
                            <path d="M100,30 L70,100" stroke-dasharray="4 4" />
                            <path d="M100,30 L130,100" />
                        </svg>`,
                "äº”è§’æŸ±": `<svg class="w-20 h-20" viewBox="0 0 200 150" stroke="#333" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" fill-opacity="0.1">
                            <polygon points="50,50 100,20 150,50 130,100 70,100" fill="#60a5fa" />
                            <polygon points="50,80 100,50 150,80 130,130 70,130" fill="#60a5fa" stroke-dasharray="4 4" style="fill-opacity: 0.2;" />
                            <path d="M50,50 L50,80 M100,20 L100,50 M150,50 L150,80 M130,100 L130,130 M70,100 L70,130" />
                            <polygon points="50,80 100,50 150,80 130,130 70,130" stroke="none" fill="#60a5fa" />
                        </svg>`,
                "äº”è§’éŒ": `<svg class="w-20 h-20" viewBox="0 0 200 150" stroke="#333" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" fill-opacity="0.1">
                            <polygon points="50,110 100,80 150,110 130,140 70,140" fill="#60a5fa" />
                            <path d="M100,30 L50,110 L70,140 Z" fill="#f87171" />
                            <path d="M100,30 L100,80" stroke-dasharray="4 4" />
                            <path d="M100,30 L150,110 L130,140 Z" fill="#f87171" />
                        </svg>`,
                "å…­è§’æŸ±": `<svg class="w-20 h-20" viewBox="0 0 200 150" stroke="#333" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" fill-opacity="0.1">
                            <polygon points="75,20 125,20 150,50 125,80 75,80 50,50" fill="#facc15" />
                            <polygon points="75,50 125,50 150,80 125,110 75,110 50,80" fill="#facc15" stroke-dasharray="4 4" style="fill-opacity: 0.2;" />
                            <path d="M75,20 L75,50 M125,20 L125,50 M150,50 L150,80 M125,80 L125,110 M75,80 L75,110 M50,50 L50,80" />
                            <polygon points="75,50 125,50 150,80 125,110 75,110 50,80" stroke="none" fill="#facc15" />
                        </svg>`,
                "å…­è§’éŒ": `<svg class="w-20 h-20" viewBox="0 0 200 150" stroke="#333" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" fill-opacity="0.1">
                            <polygon points="75,80 125,80 150,110 125,140 75,140 50,110" fill="#facc15" />
                            <path d="M100,30 L75,80 L50,110 Z" fill="#f87171" />
                            <path d="M100,30 L75,140" stroke-dasharray="4 4" />
                            <path d="M100,30 L125,140" stroke-dasharray="4 4" />
                            <path d="M100,30 L150,110 L125,80 Z" fill="#f87171" />
                        </svg>`,
                "åœ“æŸ±": `<svg class="w-20 h-20" viewBox="0 0 200 150" stroke="#333" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" fill-opacity="0.1">
                            <ellipse cx="100" cy="40" rx="50" ry="20" fill="#60a5fa" />
                            <path d="M50 40 L50 110" />
                            <path d="M150 40 L150 110" />
                            <path d="M50 40 L50 110 A50 20 0 0 0 150 110 L150 40" fill="#a5b4fc" style="fill-opacity: 0.5;" />
                            <ellipse cx="100" cy="110" rx="50" ry="20" fill="#60a5fa" style="fill-opacity: 0.2;" />
                            <path d="M50,110 A50,20 0 0,1 150,110" fill="none" />
                        </svg>`,
                "åœ“éŒ": `<svg class="w-20 h-20" viewBox="0 0 200 150" stroke="#333" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" fill-opacity="0.1">
                            <path d="M50,110 L100,30 L150,110" fill="#fca5a5" />
                            <ellipse cx="100" cy="110" rx="50" ry="20" fill="#f87171" style="fill-opacity: 0.2;" />
                            <path d="M50,110 A50,20 0 0,1 150,110" fill="none" />
                        </svg>`,
                "çƒé«”": `<svg class="w-20 h-20" viewBox="0 0 200 150" stroke="#333" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" fill-opacity="0.1">
                            <circle cx="100" cy="75" r="60" fill="#34d399" />
                            <ellipse cx="100" cy="75" rx="25" ry="60" fill="none" stroke-dasharray="4 4" style="stroke-opacity: 0.7;" />
                            <ellipse cx="100" cy="75" rx="55" ry="20" fill="none" stroke-dasharray="4 4" style="stroke-opacity: 0.7;" />
                        </svg>`,
                "è§’éŒ": `<svg class="w-20 h-20" viewBox="0 0 200 150" stroke="#333" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" fill-opacity="0.1">
                            <polygon points="50,130 150,130 100,100" fill="#f87171" style="fill-opacity: 0.3;" />
                            <path d="M100,30 L50,130" />
                            <path d="M100,30 L150,130" />
                            <path d="M100,30 L100,100" stroke-dasharray="4 4" />
                            <polygon points="100,30 50,130 150,130" fill="#f87171" />
                            <polygon points="100,30 150,130 100,100" fill="#f87171" />
                            <polygon points="100,30 50,130 100,100" fill="#f87171" style="fill-opacity: 0.3;" />
                            <path d="M50,130 L100,100 L150,130" stroke-dasharray="4 4" fill="none" />
                        </svg>`,
                "placeholder": `<svg class="w-20 h-20" viewBox="0 0 100 100" fill="none" stroke="currentColor" stroke-width="4" stroke-linejoin="round">
                            <path d="M20 20 L80 80 M20 80 L80 20" />
                        </svg>`
            },
            questions: [
                { description: "æˆ‘ç¸½å…±æœ‰5å€‹é¢ã€‚<br>æˆ‘çš„å…©å€‹åº•æ˜¯ä¸‰è§’å½¢ï¼Œå¦å¤–3å€‹å´é¢æ˜¯é•·æ–¹å½¢ã€‚<br>è«‹å•æˆ‘æ˜¯èª°ï¼Ÿ", options: ["ä¸‰è§’æŸ±", "ä¸‰è§’éŒ", "å››è§’æŸ±", "åœ“æŸ±"], answer: "ä¸‰è§’æŸ±" },
                { description: "æˆ‘ä¹Ÿæœ‰5å€‹é¢ã€‚<br>ä½†æˆ‘åªæœ‰1å€‹åº•ï¼Œå®ƒæ˜¯å››é‚Šå½¢ã€‚<br>æˆ‘çš„4å€‹å´é¢éƒ½æ˜¯ä¸‰è§’å½¢ï¼Œè€Œä¸”å®ƒå€‘çš„é ‚é»æœƒé›†ä¸­åœ¨åŒä¸€é»ã€‚", options: ["å››è§’æŸ±", "ä¸‰è§’éŒ", "å››è§’éŒ", "äº”è§’æŸ±"], answer: "å››è§’éŒ" },
                { description: "æˆ‘æœ‰7å€‹é¢ã€‚<br>æˆ‘çš„å…©å€‹åº•æ˜¯äº”é‚Šå½¢ã€‚<br>æˆ‘çš„5å€‹å´é¢éƒ½æ˜¯é•·æ–¹å½¢ã€‚<br>è«‹å•æˆ‘æ˜¯èª°ï¼Ÿ", options: ["äº”è§’éŒ", "å…­è§’æŸ±", "åœ“æŸ±", "äº”è§’æŸ±"], answer: "äº”è§’æŸ±" },
                { description: "æˆ‘æœ‰å…©å€‹å¹³å¦çš„åº•ï¼Œå®ƒå€‘éƒ½æ˜¯åœ“å½¢çš„ã€‚<br>æˆ‘é‚„æœ‰ä¸€å€‹å´é¢ï¼Œä½†å®ƒæ˜¯å½æ›²çš„ï¼ˆæ›²é¢ï¼‰ã€‚", options: ["åœ“éŒ", "çƒé«”", "åœ“æŸ±", "ä¸‰è§’æŸ±"], answer: "åœ“æŸ±" },
                { description: "æˆ‘åªæœ‰ä¸€å€‹å¹³å¦çš„åº•ï¼Œæ˜¯åœ“å½¢çš„ã€‚<br>æˆ‘é‚„æœ‰ä¸€å€‹æ›²é¢ï¼Œå®ƒæœƒé€£åˆ°ä¸€å€‹å°–å°–çš„é ‚é»ã€‚", options: ["åœ“éŒ", "ä¸‰è§’éŒ", "åœ“æŸ±", "å››è§’éŒ"], answer: "åœ“éŒ" },
                { description: "æˆ‘æ²’æœ‰ä»»ä½•å¹³å¦çš„é¢ã€‚<br>æˆ‘æ•´å€‹èº«é«”éƒ½æ˜¯ç”±ä¸€å€‹æ›²é¢çµ„æˆçš„ã€‚<br>è«‹å•æˆ‘æ˜¯èª°ï¼Ÿ", options: ["åœ“æŸ±", "åœ“éŒ", "çƒé«”", "è§’éŒ"], answer: "çƒé«”" },
                { description: "æˆ‘æœ‰8å€‹é¢ã€‚<br>æˆ‘çš„å…©å€‹åº•æ˜¯å…­é‚Šå½¢ã€‚<br>æˆ‘çš„6å€‹å´é¢éƒ½æ˜¯é•·æ–¹å½¢ã€‚", options: ["å…­è§’éŒ", "äº”è§’æŸ±", "å…­è§’æŸ±", "å››è§’æŸ±"], answer: "å…­è§’æŸ±" }
            ],

            // --- éŠæˆ²ç‹€æ…‹è®Šæ•¸ ---
            currentQuestionIndex: 0,
            isAnswered: false,
            
            // --- DOM å…ƒç´  (æœƒ
            questionDescription: null,
            progressText: null,
            optionsGrid: null,
            feedbackMessage: null,
            nextBtn: null,
            restartBtn: null,

            /** åˆå§‹åŒ–éŠæˆ² */
            init: function() {
                document.title = "ç«‹é«”åœ–å½¢çŒœçŒœçœ‹"; // è¨­å®šé é¢æ¨™é¡Œ
                
                // ç²å– DOM å…ƒç´ 
                this.questionDescription = document.getElementById('g1-question-description');
                this.progressText = document.getElementById('g1-progress-text');
                this.optionsGrid = document.getElementById('g1-options-grid');
                this.feedbackMessage = document.getElementById('g1-feedback-message');
                this.nextBtn = document.getElementById('g1-next-btn');
                this.restartBtn = document.getElementById('g1-restart-btn');

                // ç¶å®šäº‹ä»¶
                this.nextBtn.onclick = () => {
                    this.currentQuestionIndex++;
                    this.loadQuestion(this.currentQuestionIndex);
                };
                this.restartBtn.onclick = () => this.init(); // é‡æ–°ç¶å®š
                
                // é–‹å§‹
                this.currentQuestionIndex = 0;
                this.isAnswered = false;
                this.nextBtn.classList.add('hidden');
                this.restartBtn.classList.add('hidden');
                this.loadQuestion(this.currentQuestionIndex);
            },

            /** è¼‰å…¥é¡Œç›® */
            loadQuestion: function(index) {
                if (index >= this.questions.length) {
                    this.showEndScreen();
                    return;
                }

                const question = this.questions[index];
                
                this.questionDescription.innerHTML = question.description;
                this.progressText.textContent = `ç¬¬ ${index + 1} / ${this.questions.length} é¡Œ`;
                
                this.optionsGrid.innerHTML = '';
                this.feedbackMessage.textContent = '';
                this.isAnswered = false;
                this.nextBtn.classList.add('hidden');

                question.options.forEach(optionName => {
                    const btn = document.createElement('button');
                    btn.className = "g1-option-btn flex flex-col items-center justify-center gap-2 bg-white border-2 border-gray-300 rounded-lg p-4 transition duration-200 ease-in-out hover:bg-gray-50 hover:border-blue-400";
                    
                    const svgIcon = this.shapesSVG[optionName] || this.shapesSVG['placeholder'];
                    
                    btn.innerHTML = `
                        ${svgIcon}
                        <span class="font-semibold text-gray-700">${optionName}</span>
                    `;
                    btn.dataset.answer = optionName;
                    
                    btn.onclick = (e) => this.handleOptionClick(e);
                    this.optionsGrid.appendChild(btn);
                });
            },

            /** è™•ç†é¸é …é»é¸äº‹ä»¶ */
            handleOptionClick: function(event) {
                if (this.isAnswered) return;
                this.isAnswered = true;

                const selectedBtn = event.currentTarget;
                const selectedAnswer = selectedBtn.dataset.answer;
                const correctAnswer = this.questions[this.currentQuestionIndex].answer;

                const allButtons = this.optionsGrid.querySelectorAll('.g1-option-btn');
                allButtons.forEach(btn => {
                    btn.disabled = true;
                    if (btn.dataset.answer === correctAnswer) {
                        btn.classList.add('reveal');
                    }
                });

                if (selectedAnswer === correctAnswer) {
                    this.feedbackMessage.textContent = 'ç­”å°äº†ï¼ğŸ‰';
                    this.feedbackMessage.className = "text-center text-xl font-bold h-8 mb-4 text-green-500";
                    selectedBtn.classList.add('correct');
                } else {
                    this.feedbackMessage.textContent = `ç­”éŒ¯äº†... æ­£ç¢ºç­”æ¡ˆæ˜¯ ${correctAnswer}`;
                    this.feedbackMessage.className = "text-center text-xl font-bold h-8 mb-4 text-red-500";
                    selectedBtn.classList.add('incorrect');
                }

                if (this.currentQuestionIndex < this.questions.length - 1) {
                    this.nextBtn.classList.remove('hidden');
                } else {
                    this.restartBtn.classList.remove('hidden');
                }
            },

            /** é¡¯ç¤ºéŠæˆ²çµæŸç•«é¢ */
            showEndScreen: function() {
                this.questionDescription.innerHTML = "æ­å–œä½ å®Œæˆäº†æ‰€æœ‰é¡Œç›®ï¼";
                this.progressText.textContent = `å·²å®Œæˆ ${this.questions.length} / ${this.questions.length} é¡Œ`;
                this.optionsGrid.innerHTML = '';
                this.feedbackMessage.textContent = 'ğŸ‘';
                this.nextBtn.classList.add('hidden');
                this.restartBtn.classList.remove('hidden');
            }
        };

        // 
        // =================================
        // éŠæˆ² 2: ç«‹é«”åœ–å½¢é…é…çœ‹ (é‚è¼¯)
        // =================================
        //
        const GameMatch = {
            // --- è³‡æ–™åº« ---
            shapeDatabase: [
                { id: 'tri_prism', name: 'ä¸‰è§’æŸ±', faces: { triangle: 2, quadrilateral: 3, pentagon: 0, hexagon: 0 } },
                { id: 'quad_prism', name: 'å››è§’æŸ±', faces: { triangle: 0, quadrilateral: 6, pentagon: 0, hexagon: 0 } },
                { id: 'penta_prism', name: 'äº”è§’æŸ±', faces: { triangle: 0, quadrilateral: 5, pentagon: 2, hexagon: 0 } },
                { id: 'hexa_prism', name: 'å…­è§’æŸ±', faces: { triangle: 0, quadrilateral: 6, pentagon: 0, hexagon: 2 } },
                { id: 'tri_pyramid', name: 'ä¸‰è§’éŒ', faces: { triangle: 4, quadrilateral: 0, pentagon: 0, hexagon: 0 } },
                { id: 'quad_pyramid', name: 'å››è§’éŒ', faces: { triangle: 4, quadrilateral: 1, pentagon: 0, hexagon: 0 } },
                { id: 'penta_pyramid', name: 'äº”è§’éŒ', faces: { triangle: 5, quadrilateral: 0, pentagon: 1, hexagon: 0 } },
                { id: 'hexa_pyramid', name: 'å…­è§’éŒ', faces: { triangle: 6, quadrilateral: 0, pentagon: 0, hexagon: 1 } },
            ],
            shapeOptions: [
                { id: 'triangle', name: 'ä¸‰è§’å½¢', svg: '<svg class="g2-shape-btn" viewBox="0 0 100 100"><polygon points="50,15 90,85 10,85" fill="#f87171" stroke="#c81e1e" stroke-width="3"/></svg>' },
                { id: 'quadrilateral', name: 'å››è§’å½¢', svg: '<svg class="g2-shape-btn" viewBox="0 0 100 100"><rect x="15" y="15" width="70" height="70" fill="#34d399" stroke="#059669" stroke-width="3" rx="5"/></svg>' },
                { id: 'pentagon', name: 'äº”è§’å½¢', svg: '<svg class="g2-shape-btn" viewBox="0 0 100 100"><polygon points="50,10 95,40 80,90 20,90 5,40" fill="#60a5fa" stroke="#2563eb" stroke-width="3"/></svg>' },
                { id: 'hexagon', name: 'å…­è§’å½¢', svg: '<svg class="g2-shape-btn" viewBox="0 0 100 100"><polygon points="50,10 90,30 90,70 50,90 10,70 10,30" fill="#facc15" stroke="#d97706" stroke-width="3"/></svg>' },
            ],
            shape3DVisuals: {
                'tri_prism': `<svg class="g2-shape-3d-svg" viewBox="0 0 200 150">
                    <polygon points="80, 50 80, 120 130, 85" fill="#f87171" style="fill-opacity: 0.2;" stroke="#c81e1e" stroke-dasharray="4 4" />
                    <polygon points="50, 30 50, 100 100, 65" fill="#f87171" stroke="#c81e1e" />
                    <polygon points="50, 100 80, 120 130, 85 100, 65" fill="#34d399" />
                    <polygon points="50, 30 80, 50 130, 85 100, 65" fill="#34d399" />
                    <polygon points="50, 30 50, 100 80, 120 80, 50" fill="#34d399" />
                    <path d="M50, 30 L80, 50" /><path d="M50, 100 L80, 120" /><path d="M100, 65 L130, 85" />
                </svg>`,
                'quad_prism': `<svg class="g2-shape-3d-svg" viewBox="0 0 200 150">
                    <rect x="50" y="30" width="100" height="90" fill="#34d399" />
                    <rect x="70" y="50" width="100" height="90" fill="#34d399" style="fill-opacity: 0.2;" stroke-dasharray="5 5" />
                    <path d="M50,30 L70,50 M150,30 L170,50 M50,120 L70,140 M150,120 L170,140" />
                    <rect x="70" y="50" width="100" height="90" stroke="none" fill="#34d399" />
                </svg>`,
                'penta_prism': `<svg class="g2-shape-3d-svg" viewBox="0 0 200 150">
                    <polygon points="50,50 100,20 150,50 130,100 70,100" fill="#60a5fa" />
                    <polygon points="50,80 100,50 150,80 130,130 70,130" fill="#60a5fa" stroke-dasharray="4 4" style="fill-opacity: 0.2;" />
                    <path d="M50,50 L50,80 M100,20 L100,50 M150,50 L150,80 M130,100 L130,130 M70,100 L70,130" />
                    <polygon points="50,80 100,50 150,80 130,130 70,130" stroke="none" fill="#60a5fa" />
                </svg>`,
                'hexa_prism': `<svg class="g2-shape-3d-svg" viewBox="0 0 200 150">
                    <polygon points="75,20 125,20 150,50 125,80 75,80 50,50" fill="#facc15" />
                    <polygon points="75,50 125,50 150,80 125,110 75,110 50,80" fill="#facc15" stroke-dasharray="4 4" style="fill-opacity: 0.2;" />
                    <path d="M75,20 L75,50 M125,20 L125,50 M150,50 L150,80 M125,80 L125,110 M75,80 L75,110 M50,50 L50,80" />
                    <polygon points="75,50 125,50 150,80 125,110 75,110 50,80" stroke="none" fill="#facc15" />
                </svg>`,
                'tri_pyramid': `<svg class="g2-shape-3d-svg" viewBox="0 0 200 150">
                    <polygon points="50, 130 150, 130 100, 100" fill="#f87171" style="fill-opacity: 0.2;" />
                    <line x1="50" y1="130" x2="150" y2="130" stroke="#c81e1e" />
                    <line x1="50" y1="130" x2="100" y2="100" stroke="#c81e1e" stroke-dasharray="4 4" />
                    <line x1="150" y1="130" x2="100" y2="100" stroke="#c81e1e" stroke-dasharray="4 4" />
                    <polygon points="100,30 50,130 150,130" fill="#f87171" />
                    <polygon points="100,30 50,130 100,100" fill="#f87171" style="fill-opacity: 0.1;" />
                    <polygon points="100,30 150,130 100,100" fill="#f87171" style="fill-opacity: 0.1;" />
                    <path d="M100,30 L50,130" /><path d="M100,30 L150,130" /><path d="M100,30 L100,100" stroke-dasharray="4 4" />
                </svg>`,
                'quad_pyramid': `<svg class="g2-shape-3d-svg" viewBox="0 0 200 150">
                    <polygon points="50,120 150,120 130,100 70,100" fill="#34d399" />
                    <path d="M100,30 L50,120 L150,120 Z" fill="#f87171" />
                    <path d="M100,30 L70,100" stroke-dasharray="4 4" />
                    <path d="M100,30 L130,100" />
                </svg>`,
                'penta_pyramid': `<svg class="g2-shape-3d-svg" viewBox="0 0 200 150">
                    <polygon points="50,110 100,80 150,110 130,140 70,140" fill="#60a5fa" />
                    <path d="M100,30 L50,110 L70,140 Z" fill="#f87171" />
                    <path d="M100,30 L100,80" stroke-dasharray="4 4" />
                    <path d="M100,30 L150,110 L130,140 Z" fill="#f87171" />
                </svg>`,
                'hexa_pyramid': `<svg class="g2-shape-3d-svg" viewBox="0 0 200 150">
                    <polygon points="75,80 125,80 150,110 125,140 75,140 50,110" fill="#facc15" />
                    <path d="M100,30 L75,80 L50,110 Z" fill="#f87171" />
                    <path d="M100,30 L75,140" stroke-dasharray="4 4" />
                    <path d="M100,30 L125,140" stroke-dasharray="4 4" />
                    <path d="M100,30 L150,110 L125,80 Z" fill="#f87171" />
                </svg>`,
            },

            // --- éŠæˆ²ç‹€æ…‹è®Šæ•¸ ---
            currentShape: null,
            playerSelection: { triangle: 0, quadrilateral: 0, pentagon: 0, hexagon: 0 },

            // --- DOM å…ƒç´  ---
            shapeNameEl: null,
            shapeVisualEl: null,
            selectionTrayEl: null,
            shapeOptionsEl: null,
            checkBtn: null,
            clearBtn: null,
            nextBtn: null,
            modal: null,
            modalIcon: null,
            modalTitle: null,
            modalMessage: null,
            modalCloseBtn: null,

            /** åˆå§‹åŒ–éŠæˆ² */
            init: function() {
                document.title = "ç«‹é«”åœ–å½¢é…é…çœ‹"; // è¨­å®šé é¢æ¨™é¡Œ

                // ç²å– DOM å…ƒç´ 
                this.shapeNameEl = document.getElementById('g2-shape-name');
                this.shapeVisualEl = document.getElementById('g2-shape-visual');
                this.selectionTrayEl = document.getElementById('g2-selection-tray');
                this.shapeOptionsEl = document.getElementById('g2-shape-options');
                this.checkBtn = document.getElementById('g2-check-btn');
                this.clearBtn = document.getElementById('g2-clear-btn');
                this.nextBtn = document.getElementById('g2-next-btn');
                this.modal = document.getElementById('g2-feedback-modal');
                this.modalIcon = document.getElementById('g2-modal-icon');
                this.modalTitle = document.getElementById('g2-modal-title');
                this.modalMessage = document.getElementById('g2-modal-message');
                this.modalCloseBtn = document.getElementById('g2-modal-close-btn');

                // æ¸²æŸ“ 2D åœ–å½¢é¸é …æŒ‰éˆ•
                this.shapeOptionsEl.innerHTML = '';
                this.shapeOptions.forEach(option => {
                    const btn = document.createElement('button');
                    btn.innerHTML = option.svg;
                    btn.setAttribute('aria-label', `åŠ å…¥${option.name}`);
                    btn.dataset.shapeId = option.id;
                    btn.className = "g2-shape-btn-container transition transform hover:scale-110";
                    this.shapeOptionsEl.appendChild(btn);
                });

                // ç¶å®šäº‹ä»¶ç›£è½ (ä½¿ç”¨ .onclick ç¢ºä¿æ¯æ¬¡ init éƒ½ç¶å®šæ­£ç¢ºçš„ 'this')
                this.shapeOptionsEl.onclick = (e) => this.handleShapeClick(e);
                this.selectionTrayEl.onclick = (e) => this.handleTrayClick(e);
                this.clearBtn.onclick = () => this.handleClearClick();
                this.checkBtn.onclick = () => this.handleCheckClick();
                this.nextBtn.onclick = () => this.loadNewQuestion();
                this.modalCloseBtn.onclick = () => this.hideFeedback();

                // è¼‰å…¥ç¬¬ä¸€å€‹å•é¡Œ
                this.loadNewQuestion();
            },

            /** è¼‰å…¥æ–°é¡Œç›® */
            loadNewQuestion: function() {
                this.currentShape = this.shapeDatabase[Math.floor(Math.random() * this.shapeDatabase.length)];
                this.handleClearClick();
                this.shapeNameEl.textContent = this.currentShape.name;
                this.shapeVisualEl.innerHTML = this.shape3DVisuals[this.currentShape.id] || '<p class="text-gray-500">åœ–å½¢è¼‰å…¥ä¸­...</p>';
                this.checkBtn.classList.remove('hidden');
                this.clearBtn.classList.remove('hidden');
                this.nextBtn.classList.add('hidden');
                this.hideFeedback();
            },

            /** è™•ç† 2D åœ–å½¢é»é¸äº‹ä»¶ (åŠ å…¥é¸æ“‡) */
            handleShapeClick: function(event) {
                const btn = event.target.closest('.g2-shape-btn-container');
                if (!btn) return;
                const shapeId = btn.dataset.shapeId;
                this.playerSelection[shapeId]++;
                const shapeData = this.shapeOptions.find(opt => opt.id === shapeId);
                if (shapeData) {
                    const shapeDiv = document.createElement('div');
                    shapeDiv.innerHTML = shapeData.svg;
                    shapeDiv.className = 'g2-selected-shape-container relative transition transform hover:scale-110';
                    shapeDiv.dataset.shapeId = shapeId;
                    shapeDiv.setAttribute('title', `é»é¸ç§»é™¤${shapeData.name}`);
                    shapeDiv.firstElementChild.classList.add('g2-selected-shape');
                    this.selectionTrayEl.appendChild(shapeDiv);
                }
            },

            /** è™•ç†é¸æ“‡å€é»é¸äº‹ä»¶ (ç§»é™¤é¸æ“‡) */
            handleTrayClick: function(event) {
                const shapeEl = event.target.closest('.g2-selected-shape-container');
                if (!shapeEl) return;
                const shapeId = shapeEl.dataset.shapeId;
                if (this.playerSelection[shapeId] > 0) {
                    this.playerSelection[shapeId]--;
                }
                shapeEl.remove();
            },

            /** è™•ç†æ¸…é™¤æŒ‰éˆ•äº‹ä»¶ */
            handleClearClick: function() {
                this.playerSelection = { triangle: 0, quadrilateral: 0, pentagon: 0, hexagon: 0 };
                this.selectionTrayEl.innerHTML = '';
            },

            /** è™•ç†æª¢æŸ¥ç­”æ¡ˆæŒ‰éˆ•äº‹ä»¶ */
            handleCheckClick: function() {
                let isCorrect = true;
                const answer = this.currentShape.faces;
                for (const key in answer) {
                    if (this.playerSelection[key] !== answer[key]) {
                        isCorrect = false;
                        break;
                    }
                }
                for (const key in this.playerSelection) {
                    if (this.playerSelection[key] > 0 && answer[key] === 0) {
                        isCorrect = false;
                        break;
                    }
                }
                this.showFeedback(isCorrect);
            },

            /** é¡¯ç¤ºå›é¥‹ Modal */
            showFeedback: function(isCorrect) {
                if (isCorrect) {
                    this.modalIcon.textContent = 'ğŸ‰';
                    this.modalTitle.textContent = 'å¤ªæ£’äº†ï¼';
                    this.modalMessage.textContent = `ä½ ç­”å°äº†ï¼ ${this.currentShape.name} çœŸçš„æœ‰é€™äº›é¢å–”ï¼`;
                    this.modalCloseBtn.textContent = 'ä¸‹ä¸€é¡Œ';
                    this.modalCloseBtn.onclick = () => this.loadNewQuestion();
                    this.checkBtn.classList.add('hidden');
                    this.clearBtn.classList.add('hidden');
                    this.nextBtn.classList.remove('hidden');
                } else {
                    this.modalIcon.textContent = 'ğŸ¤”';
                    this.modalTitle.textContent = 'å·®ä¸€é»é»ï¼';
                    this.modalMessage.textContent = 'é¢çš„ç¨®é¡æˆ–æ•¸é‡ä¸å°å–”ï¼Œè«‹å†è©¦ä¸€æ¬¡ï¼';
                    this.modalCloseBtn.textContent = 'çŸ¥é“äº†';
                    this.modalCloseBtn.onclick = () => this.hideFeedback();
                }
                this.modal.classList.add('g2-modal-show');
            },

            /** éš±è—å›é¥‹ Modal */
            hideFeedback: function() {
                this.modal.classList.remove('g2-modal-show');
            }
        };

        // 
        // =================================
        // é é¢å°èˆª (Navigation) é‚è¼¯
        // =================================
        //
        document.addEventListener('DOMContentLoaded', () => {
            // ç²å–æ‰€æœ‰ç•«é¢
            const screens = {
                'start-screen': document.getElementById('start-screen'),
                'game-guess-screen': document.getElementById('game-guess-screen'),
                'game-match-screen': document.getElementById('game-match-screen')
            };
            const gameMatchModal = document.getElementById('g2-feedback-modal');

            // ç²å–è§¸ç™¼æŒ‰éˆ•
            const playGuessBtn = document.getElementById('play-guess-btn');
            const playMatchBtn = document.getElementById('play-match-btn');
            const backBtns = document.querySelectorAll('.back-btn');

            // é¡¯ç¤ºç‰¹å®šç•«é¢çš„å‡½å¼
            const showScreen = (screenId) => {
                // éš±è—æ‰€æœ‰ç•«é¢
                for (const id in screens) {
                    screens[id].classList.add('hidden');
                }
                // éš±è— modal
                gameMatchModal.classList.remove('g2-modal-show');

                // é¡¯ç¤ºç›®æ¨™ç•«é¢
                if (screens[screenId]) {
                    screens[screenId].classList.remove('hidden');
                }

                // å¦‚æœæ˜¯éŠæˆ²ç•«é¢ï¼Œåˆå§‹åŒ–å®ƒ
                if (screenId === 'game-guess-screen') {
                    GameGuess.init();
                } else if (screenId === 'game-match-screen') {
                    GameMatch.init();
                } else {
                    document.title = "ç«‹é«”åœ–å½¢éŠæˆ²"; // é‡è¨­æ¨™é¡Œ
                }
            };

            // ç¶å®šé–‹å§‹éŠæˆ²æŒ‰éˆ•
            playGuessBtn.addEventListener('click', () => showScreen('game-guess-screen'));
            playMatchBtn.addEventListener('click', () => showScreen('game-match-screen'));

            // ç¶å®šæ‰€æœ‰è¿”å›æŒ‰éˆ•
            backBtns.forEach(btn => {
                btn.addEventListener('click', (e) => showScreen(e.target.dataset.target));
            });

            // é è¨­é¡¯ç¤ºé–‹å§‹ç•«é¢
            showScreen('start-screen');
        });

    </script>
</body>
</html>


